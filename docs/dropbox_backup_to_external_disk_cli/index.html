<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="dropbox_backup_to_external_disk_cli"><title>dropbox_backup_to_external_disk_cli - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../static.files/rustdoc-84e720fa.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="dropbox_backup_to_external_disk_cli" data-themes="" data-resource-suffix="" data-rustdoc-version="1.89.0 (29483883e 2025-08-04)" data-channel="1.89.0" data-search-js="search-92309212.js" data-settings-js="settings-5514c975.js" ><script src="../static.files/storage-4e99c027.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-fd3af306.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-32bb7600.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-6580c154.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-044be391.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../dropbox_backup_to_external_disk_cli/index.html">dropbox_<wbr>backup_<wbr>to_<wbr>external_<wbr>disk_<wbr>cli</a><span class="version">2025.926.1538</span></h2></div><div class="sidebar-elems"><ul class="block"><li><a id="all-types" href="all.html">All Items</a></li></ul><section id="rustdoc-toc"><h3><a href="#">Sections</a></h3><ul class="block top-toc"><li><a href="#dropbox_backup_to_external_disk_cli" title="dropbox_backup_to_external_disk_cli">dropbox_backup_to_external_disk_cli</a><ul><li><a href="#cli" title="CLI">CLI</a></li><li><a href="#cross-compile-to-windows" title="Cross compile to windows">Cross compile to windows</a></li><li><a href="#development" title="Development">Development</a></li><li><a href="#try-it" title="Try it">Try it</a></li><li><a href="#warning" title="Warning">Warning</a></li><li><a href="#bash-auto-completion" title="bash auto-completion">bash auto-completion</a></li><li><a href="#authorization-oauth2" title="Authorization OAuth2">Authorization OAuth2</a></li><li><a href="#open-source-and-free-as-a-beer" title="Open-source and free as a beer">Open-source and free as a beer</a></li></ul></li></ul><h3><a href="#modules">Crate Items</a></h3><ul class="block"><li><a href="#modules" title="Modules">Modules</a></li><li><a href="#functions" title="Functions">Functions</a></li></ul></section><div id="rustdoc-modnav"></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><h1>Crate <span>dropbox_backup_to_external_disk_cli</span><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../src/dropbox_backup_to_external_disk_cli/main.rs.html#8-969">Source</a> </span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><!-- markdownlint-disable MD041 -->
<h2 id="dropbox_backup_to_external_disk_cli"><a class="doc-anchor" href="#dropbox_backup_to_external_disk_cli">§</a>dropbox_backup_to_external_disk_cli</h2>
<p><strong>CLI binary executable, one-way sync from Dropbox to external disc</strong><br />
<em><strong>version: 2025.926.1538 date: 2025-09-26 author: <a href="https://bestia.dev">bestia.dev</a> repository: <a href="https://github.com/bestia-dev/dropbox_backup_to_external_disk_cli/">GitHub</a></strong></em></p>
<p><img src="https://img.shields.io/badge/dropbox-orange" alt="dropbox" />
<img src="https://img.shields.io/badge/maintained-green" alt="maintained" />
<img src="https://img.shields.io/badge/ready_for_use-green" alt="ready-for-use" /></p>
<p><a href="https://github.com/bestia-dev/dropbox_backup_to_external_disk_cli/"><img src="https://img.shields.io/badge/Lines_in_Rust-867-green.svg" alt="Lines in Rust code" /></a>
<a href="https://github.com/bestia-dev/dropbox_backup_to_external_disk_cli/"><img src="https://img.shields.io/badge/Lines_in_Doc_comments-48-blue.svg" alt="Lines in Doc comments" /></a>
<a href="https://github.com/bestia-dev/dropbox_backup_to_external_disk_cli/"><img src="https://img.shields.io/badge/Lines_in_comments-129-purple.svg" alt="Lines in Comments" /></a>
<a href="https://github.com/bestia-dev/dropbox_backup_to_external_disk_cli/"><img src="https://img.shields.io/badge/Lines_in_examples-0-yellow.svg" alt="Lines in examples" /></a>
<a href="https://github.com/bestia-dev/dropbox_backup_to_external_disk_cli/"><img src="https://img.shields.io/badge/Lines_in_tests-0-orange.svg" alt="Lines in tests" /></a></p>
<p><a href="https://github.com/bestia-dev/dropbox_backup_to_external_disk_2/blob/main/LICENSE"><img src="https://img.shields.io/badge/license-MIT-blue.svg" alt="License" /></a>
<a href="https://github.com/bestia-dev/dropbox_backup_to_external_disk_2/"><img src="https://github.com/bestia-dev/dropbox_backup_to_external_disk_2/workflows/rust_fmt_auto_build_test/badge.svg" alt="Rust" /></a>
<img src="https://bestia.dev/webpage_hit_counter/get_svg_image/772745756.svg" alt="dropbox_backup_to_external_disk_cli" /></p>
<p>Hashtags: #rustlang #tutorial #dropbox #maintained #work_in_progress #cli
My projects on Github are more like a tutorial than a finished product: <a href="https://github.com/bestia-dev/tutorials_rust_wasm">bestia-dev tutorials</a>.</p>
<h3 id="cli"><a class="doc-anchor" href="#cli">§</a>CLI</h3>
<p>This compiles into a CLI binary executable. All the user interface is inside this project.<br />
The main dependency is to the library project <code>dropbox_backup_to_external_disk_lib</code> that contains all the program logic.  I separated this projects to show how to use the same library from different binary projects. It is difficult to separate this two layers afterwards. They should be separated from the start.<br />
Different user-interfaces need different workflows and the common library must allow this. Modern computers and phones are all multi-core. Even javascript has multi-thread capabilities with web-workers. It is recommended to create multi-threaded applications. Most of the calls to the library will be done in a separate thread to have the possibility of communication between the 2 layers (UI and logic). For example for progress bars and similar long running tasks.</p>
<h3 id="cross-compile-to-windows"><a class="doc-anchor" href="#cross-compile-to-windows">§</a>Cross compile to windows</h3>
<p>On my machine I have Windows11 with WSL/Debian. My external drive is exFAT and it works nice with windows. But from WSL it does not work well. WSL/Debian cannot change the datetime of files on the external drive.</p>
<p>Therefore I will cross compile to Windows, copy the exe file with <code>scp</code> and run it on Windows.</p>
<p>From Windows it takes cold 16 seconds and hot 2 seconds to list the Local external drive folder. In WSL it takes forever.</p>
<p>Copy the exe file from the container ‘crustde’ to win folder. Run in windows git-bash:</p>
<div class="example-wrap"><pre class="language-bash"><code>scp rustdevuser@crustde:/home/rustdevuser/rustprojects/dropbox_backup_to_external_disk_cli/target/x86_64-pc-windows-gnu/release/dropbox_backup_to_external_disk_cli.exe /c/Users/Luciano/rustprojects/dropbox_backup_to_external_disk/

# then run the local_list with the path like this in git-bash
cd rustprojects/dropbox_backup_to_external_disk
alias dropbox_backup_to_external_disk_cli=./dropbox_backup_to_external_disk_cli
complete -C &quot;dropbox_backup_to_external_disk_cli completion&quot; dropbox_backup_to_external_disk_cli

</code></pre></div><h3 id="development"><a class="doc-anchor" href="#development">§</a>Development</h3>
<p>I use <code>cargo-auto</code> to write all repetitive tasks in <code>automation_tasks_rs</code>.</p>
<h3 id="try-it"><a class="doc-anchor" href="#try-it">§</a>Try it</h3>
<p>There are a few manual steps for the security of you files on Dropbox. Authentication on internet is a complex topic.<br />
You should be logged in Linux terminal (also in WSL2) with your account. So things you do in that session, are not visible to others. You will set some local environment variables that are private/secret to your linux Session.  After you logout from you Linux session these local environment variables will be deleted.<br />
The executable will create a sub-directory <code>tmp</code> in the current directory. Maybe it is best if you create a dedicated directory <code>~/dropbox_backup_to_external_disk_cli/</code> just for this executable and <code>tmp</code>.
Download the latest release from <a href="https://github.com/bestia-dev/dropbox_backup_to_external_disk_lib/releases">Github</a> and make the file executable and enable auto-completion:</p>
<div class="example-wrap"><pre class="language-bash"><code>cd ~
mkdir dropbox_backup_to_external_disk_cli
cd dropbox_backup_to_external_disk_cli

curl -L https://github.com/bestia-dev/dropbox_backup_to_external_disk_lib/releases/latest/download/dropbox_backup_to_external_disk_cli --output dropbox_backup_to_external_disk_cli

chmod +x dropbox_backup_to_external_disk_cli
alias dropbox_backup_to_external_disk_cli=./dropbox_backup_to_external_disk_cli
complete -C &quot;dropbox_backup_to_external_disk_cli completion&quot; dropbox_backup_to_external_disk_cli

dropbox_backup_to_external_disk_cli</code></pre></div>
<p>Run the executable without arguments and follow carefully the instructions.</p>
<h3 id="warning"><a class="doc-anchor" href="#warning">§</a>Warning</h3>
<p>I don’t know why, but WSL2 sometimes does not see all the folders of the external disk.<br />
Instead of 12.000 folders it sees only 28 ???<br />
Be careful !<br />
Check it first with this commands to see if the removable disk is really mounted or you see a phantom cached file system.</p>
<div class="example-wrap"><pre class="language-bash"><code>ls /mnt/d
# and/or
df</code></pre></div>
<p>I then restart my Win10 and the problem magically disappears.</p>
<h3 id="bash-auto-completion"><a class="doc-anchor" href="#bash-auto-completion">§</a>bash auto-completion</h3>
<p>This executable is prepared for auto-completion in bash.<br />
Run this command to define auto-completion in bash for the current session:</p>
<div class="example-wrap"><pre class="language-bash"><code>alias dropbox_backup_to_external_disk_cli=./dropbox_backup_to_external_disk_cli
complete -C &quot;dropbox_backup_to_external_disk_cli completion&quot; dropbox_backup_to_external_disk_cli</code></pre></div>
<p>To make it permanent add this command to the file <code>~/.bashrc</code> or some other file that runs commands on bash initialization.</p>
<h3 id="authorization-oauth2"><a class="doc-anchor" href="#authorization-oauth2">§</a>Authorization OAuth2</h3>
<p>Authorization on the internet is a mess. Dropbox api uses OAuth2.
Every app must be authorized on Dropbox and have its own <code>app key</code> and <code>app secret</code>.<br />
For commercial programs they probably embed them into the binary code somehow. But for OpenSource projects it is not possible to keep a secret. So the workaround is: every user must create its own new <code>dropbox app</code> exclusive only to him. Creating a new app is simple. This app will stay forever in <code>development status</code> in dropbox, to be more private and secure. The<br />
<code>$ dropbox_backup_to_external_disk_cli --help</code><br />
has the detailed instructions.<br />
Then every time before use we need generate the “short-lived access token” for security reasons. There is the possibility to choose “no expiration” token, but I don’t like it. Dropbox backup is used rarely and it is not super frustrating to make few clicks for security of your precious files. Having a “no expiration” token is like having another password for the hackers to try to hack. I like more the “short-lived” token. When I’m not using this backup program, there is no access token at all.<br />
TODO: use the complete OAuth protocol instead of short-lived token</p>
<p><img src="https://github.com/bestia-dev/dropbox_backup_to_external_disk_lib/raw/main/images/dropbox_2.png" alt="dropbox_2" title="dropbox_2" /> <img src="https://github.com/bestia-dev/dropbox_backup_to_external_disk_lib/raw/main/images/dropbox_1.png" alt="dropbox_1" title="dropbox_1" />
Use this command to store the token (encrypted) in env variable. It will ask for your interactive input like a secret password.</p>
<div class="example-wrap"><pre class="language-bash"><code>dropbox_backup_to_external_disk_cli encode_token</code></pre></div><h3 id="open-source-and-free-as-a-beer"><a class="doc-anchor" href="#open-source-and-free-as-a-beer">§</a>Open-source and free as a beer</h3>
<p>My open-source projects are free as a beer (MIT license).<br />
I just love programming.<br />
But I need also to drink. If you find my projects and tutorials helpful, please buy me a beer by donating to my <a href="https://paypal.me/LucianoBestia">PayPal</a>.<br />
You know the price of a beer in your local bar ;-)<br />
So I can drink a free beer for your health :-)<br />
<a href="https://translate.google.com/?hl=en&amp;sl=sl&amp;tl=en&amp;text=Na%20zdravje&amp;op=translate">Na zdravje!</a> <a href="https://dictionary.cambridge.org/dictionary/italian-english/alla-salute">Alla salute!</a> <a href="https://dictionary.cambridge.org/dictionary/german-english/prost">Prost!</a> <a href="https://matadornetwork.com/nights/how-to-say-cheers-in-50-languages/">Nazdravlje!</a> 🍻</p>
<p><a href="https://bestia.dev">//bestia.dev</a><br />
<a href="https://github.com/bestia-dev">//github.com/bestia-dev</a><br />
<a href="https://bestiadev.substack.com">//bestiadev.substack.com</a><br />
<a href="https://youtube.com/@bestia-dev-tutorials">//youtube.com/@bestia-dev-tutorials</a></p>
</div></details><h2 id="modules" class="section-header">Modules<a href="#modules" class="anchor">§</a></h2><dl class="item-table"><dt><a class="mod" href="app_state_mod/index.html" title="mod dropbox_backup_to_external_disk_cli::app_state_mod">app_<wbr>state_<wbr>mod</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dt><a class="mod" href="crossterm_cli_mod/index.html" title="mod dropbox_backup_to_external_disk_cli::crossterm_cli_mod">crossterm_<wbr>cli_<wbr>mod</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>CLI interface using the crossterm crate</dd></dl><h2 id="functions" class="section-header">Functions<a href="#functions" class="anchor">§</a></h2><dl class="item-table"><dt><a class="fn" href="fn.all_list.html" title="fn dropbox_backup_to_external_disk_cli::all_list">all_<wbr>list</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>List local and remote in a multiple threads, then receive messages to print on screen.</dd><dt><a class="fn" href="fn.argument_router.html" title="fn dropbox_backup_to_external_disk_cli::argument_router">argument_<wbr>router</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>Look at the arguments and route to appropriate function.</dd><dt><a class="fn" href="fn.change_time_files.html" title="fn dropbox_backup_to_external_disk_cli::change_time_files">change_<wbr>time_<wbr>files</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>Change time of files.</dd><dt><a class="fn" href="fn.check_and_save_ext_disk_base_path.html" title="fn dropbox_backup_to_external_disk_cli::check_and_save_ext_disk_base_path">check_<wbr>and_<wbr>save_<wbr>ext_<wbr>disk_<wbr>base_<wbr>path</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>Check if external disk base path exists.  \</dd><dt><a class="fn" href="fn.compare_files.html" title="fn dropbox_backup_to_external_disk_cli::compare_files">compare_<wbr>files</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>Compare files.</dd><dt><a class="fn" href="fn.compare_folders.html" title="fn dropbox_backup_to_external_disk_cli::compare_folders">compare_<wbr>folders</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>Compare folders.</dd><dt><a class="fn" href="fn.completion.html" title="fn dropbox_backup_to_external_disk_cli::completion">completion</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>Sub-command for bash auto-completion of <code>cargo auto</code> using the crate <code>dev_bestia_cargo_completion</code>.</dd><dt><a class="fn" href="fn.create_folders.html" title="fn dropbox_backup_to_external_disk_cli::create_folders">create_<wbr>folders</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>Create folders.</dd><dt><a class="fn" href="fn.download_from_list.html" title="fn dropbox_backup_to_external_disk_cli::download_from_list">download_<wbr>from_<wbr>list</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>Download from list.</dd><dt><a class="fn" href="fn.download_one_file.html" title="fn dropbox_backup_to_external_disk_cli::download_one_file">download_<wbr>one_<wbr>file</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>Download one file.</dd><dt><a class="fn" href="fn.empty_lists_compared.html" title="fn dropbox_backup_to_external_disk_cli::empty_lists_compared">empty_<wbr>lists_<wbr>compared</a></dt><dd>Empty lists created by compare.</dd><dt><a class="fn" href="fn.get_ext_disk_base_path.html" title="fn dropbox_backup_to_external_disk_cli::get_ext_disk_base_path">get_<wbr>ext_<wbr>disk_<wbr>base_<wbr>path</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>Read ext_disk_base_path from file path_list_ext_disk_base_path.</dd><dt><a class="fn" href="fn.local_list.html" title="fn dropbox_backup_to_external_disk_cli::local_list">local_<wbr>list</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>List in a new thread, then receive messages to print on screen.</dd><dt><a class="fn" href="fn.main.html" title="fn dropbox_backup_to_external_disk_cli::main">main</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dt><a class="fn" href="fn.main_with_catch_errors.html" title="fn dropbox_backup_to_external_disk_cli::main_with_catch_errors">main_<wbr>with_<wbr>catch_<wbr>errors</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dt><a class="fn" href="fn.move_local_files.html" title="fn dropbox_backup_to_external_disk_cli::move_local_files">move_<wbr>local_<wbr>files</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>Move local files.</dd><dt><a class="fn" href="fn.print_help.html" title="fn dropbox_backup_to_external_disk_cli::print_help">print_<wbr>help</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>Print help.</dd><dt><a class="fn" href="fn.print_next_step.html" title="fn dropbox_backup_to_external_disk_cli::print_next_step">print_<wbr>next_<wbr>step</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>Depending on the last_Step the next step is printed.</dd><dt><a class="fn" href="fn.read_only_remove.html" title="fn dropbox_backup_to_external_disk_cli::read_only_remove">read_<wbr>only_<wbr>remove</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>The backup files must not be readonly to allow copying the modified file from the remote.</dd><dt><a class="fn" href="fn.remote_list.html" title="fn dropbox_backup_to_external_disk_cli::remote_list">remote_<wbr>list</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dt><a class="fn" href="fn.rename_local_files.html" title="fn dropbox_backup_to_external_disk_cli::rename_local_files">rename_<wbr>local_<wbr>files</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>Rename local files.</dd><dt><a class="fn" href="fn.spawn_list_local.html" title="fn dropbox_backup_to_external_disk_cli::spawn_list_local">spawn_<wbr>list_<wbr>local</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dt><a class="fn" href="fn.spawn_list_remote.html" title="fn dropbox_backup_to_external_disk_cli::spawn_list_remote">spawn_<wbr>list_<wbr>remote</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dt><a class="fn" href="fn.trash_files.html" title="fn dropbox_backup_to_external_disk_cli::trash_files">trash_<wbr>files</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>Trash files from list.</dd><dt><a class="fn" href="fn.trash_folders.html" title="fn dropbox_backup_to_external_disk_cli::trash_folders">trash_<wbr>folders</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>Trash folders must be the last command, to avoid deleting before move or rename.</dd><dt><a class="fn" href="fn.ui_encode_token.html" title="fn dropbox_backup_to_external_disk_cli::ui_encode_token">ui_<wbr>encode_<wbr>token</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>Ask the user to paste the token interactively and press Enter. Then calculate the master_key and the token_enc.  \</dd><dt><a class="fn" href="fn.ui_test_connection.html" title="fn dropbox_backup_to_external_disk_cli::ui_test_connection">ui_<wbr>test_<wbr>connection</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>Test connection.</dd></dl></section></div></main></body></html>